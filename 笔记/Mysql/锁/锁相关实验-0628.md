```sql
session 1

BEGIN

SELECT TYPE FROM sql_lock WHERE TYPE = 5 lock in share MODE;

FOR UPDATE;
--UPDATE sql_lock SET TYPE = 5 WHERE TYPE = 5;

ROLLBACK;


```

```sql
session 2

BEGIN

--执行成功
UPDATE sql_lock SET TYPE = 7 WHERE TYPE = 7;

--失败
INSERT INTO 
sql_lock 
(`id`, `code`, `name`, role, phone, `type`, `age`, `create_time`) 
VALUES 
(26, 'insert-06281041', '插入-06281041', 'm', '456', 7, '15', '2021-06-28 10:41:03');

ROLLBACK;

```

```sql
session 3
-- 查看当前所有事务
select * from information_schema.innodb_trx;


--innodb_locks表在8.0.13版本，由performance_schema.data_locks表所代替
-- 查看正在锁的事务
select * from performance_schema.data_locks;

--innodb_lock_waits表在8.0.13版本，由performance_schema.data_lock_waits表代替。
-- 查看等待锁的事务
select * from performance_schema.data_lock_waits;

-- 显示连接列表（查询 ID）
show full PROCESSLIST;

--杀掉线程
KILL 9738;

--查看最近一次死锁日志
set global innodb_status_output_locks = on;
show engine innodb STATUS;

--查看mysql版本
select @@VERSION;
```

